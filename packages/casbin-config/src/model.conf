[request_definition]
r = sub, obj, act, org, portal, role

[policy_definition]
p = sub, obj, act, org, eft, portal, role

[role_definition]
g = _, _, _              # User role hierarchy (user, role, organization)
g2 = _, _, _             # Organization-based roles
g3 = _, _, _             # Portal hierarchy (tech > admin > customer/vendor)
g4 = _, _, _             # Role hierarchy within portal (tech_admin > tech_manager > tech_user)

[policy_effect]
e = some(where (p.eft == allow)) && !some(where (p.eft == deny))

[matchers]
m = g(r.sub, p.sub, r.org) && g2(r.org, p.org, "*") && g3(r.portal, p.portal, "*") && g4(r.role, p.role, r.portal) && r.obj == p.obj && r.act == p.act







